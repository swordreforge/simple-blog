<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, viewport-fit=cover">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#000000" media="(prefers-color-scheme: dark)">
<title>文件管理 - 管理员</title>
<link rel="stylesheet" href="/css/filemanager.css">
  <link rel="stylesheet" href="/css/modal-animations.css" media="print" onload="this.media='all'"></head>
<body>
  <div class="file-manager-container">
    <!-- 顶部导航栏 -->
    <div class="fm-header">
      <div class="fm-header-left">
        <button id="backBtn" class="fm-btn fm-btn-secondary" disabled>
          <span class="fm-icon">←</span>
        </button>
        <div class="breadcrumb">
          <span id="currentPath">/</span>
        </div>
      </div>
      <div class="fm-header-right">
        <button id="uploadBtn" class="fm-btn fm-btn-primary">
          <span class="fm-icon">↑</span>
          上传文件
        </button>
        <button id="createDirBtn" class="fm-btn fm-btn-secondary">
          <span class="fm-icon">+</span>
          新建文件夹
        </button>
      </div>
    </div>

    <!-- 根目录切换 -->
    <div class="fm-root-selector">
      <button class="fm-root-btn fm-root-btn-active" data-path="img">
        <span class="fm-icon">📁</span>
        图片 (img)
      </button>
      <button class="fm-root-btn" data-path="markdown">
        <span class="fm-icon">📄</span>
        文档 (markdown)
      </button>
      <button class="fm-root-btn" data-path="attachments">
        <span class="fm-icon">📎</span>
        附件管理
      </button>
      <button class="fm-root-btn" data-path="music">
        <span class="fm-icon">🎵</span>
        音乐 (music)
      </button>
    </div>

    <!-- 文件列表区域 -->
    <div class="fm-content">
      <div id="fileGrid" class="file-grid">
        <!-- 文件项将通过JavaScript动态生成 -->
      </div>
      <div id="emptyState" class="empty-state" style="display: none;">
        <div class="empty-icon">📭</div>
        <p>此文件夹为空</p>
      </div>
    </div>

    <!-- 底部状态栏 -->
    <div class="fm-footer">
      <span id="fileCount">0 个项目</span>
    </div>
  </div>

  <!-- 上传模态框 -->
  <div id="uploadModal" class="fm-modal">
    <div class="fm-modal-content">
      <div class="fm-modal-header">
        <h3>上传文件</h3>
        <button class="fm-modal-close">&times;</button>
      </div>
      <div class="fm-modal-body">
        <div id="uploadArea" class="upload-area">
          <div class="upload-icon">📤</div>
          <div class="upload-text">
            <h4>拖拽文件到这里或点击上传</h4>
            <p>支持图片、文档、视频、音频、压缩包</p>
          </div>
          <input type="file" id="fileInput" multiple style="display: none;">
        </div>
        <div id="uploadList" class="upload-list"></div>
      </div>
      <div class="fm-modal-footer">
        <button class="fm-btn fm-btn-secondary fm-modal-close-btn">取消</button>
        <button id="confirmUploadBtn" class="fm-btn fm-btn-primary" disabled>上传</button>
      </div>
    </div>
  </div>

  <!-- 新建文件夹模态框 -->
  <div id="createDirModal" class="fm-modal">
    <div class="fm-modal-content">
      <div class="fm-modal-header">
        <h3>新建文件夹</h3>
        <button class="fm-modal-close">&times;</button>
      </div>
      <div class="fm-modal-body">
        <div class="fm-form-group">
          <label for="dirNameInput">文件夹名称</label>
          <input type="text" id="dirNameInput" class="fm-input" placeholder="请输入文件夹名称">
        </div>
      </div>
      <div class="fm-modal-footer">
        <button class="fm-btn fm-btn-secondary fm-modal-close-btn">取消</button>
        <button id="confirmCreateDirBtn" class="fm-btn fm-btn-primary">创建</button>
      </div>
    </div>
  </div>

  <!-- 重命名模态框 -->
  <div id="renameModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>重命名</h3>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="renameInput">新名称</label>
          <input type="text" id="renameInput" class="form-control" placeholder="请输入新名称">
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary fm-modal-close-btn">取消</button>
        <button id="confirmRenameBtn" class="btn-primary">确定</button>
      </div>
    </div>
  </div>

  <!-- 删除确认模态框 -->
  <div id="deleteModal" class="fm-modal">
    <div class="fm-modal-content">
      <div class="fm-modal-header">
        <h3>确认删除</h3>
        <button class="fm-modal-close">&times;</button>
      </div>
      <div class="fm-modal-body">
        <p>确定要删除 <strong id="deleteFileName"></strong> 吗？</p>
        <p class="fm-warning-text">此操作不可恢复！</p>
      </div>
      <div class="fm-modal-footer">
        <button class="fm-btn fm-btn-secondary fm-modal-close-btn">取消</button>
        <button id="confirmDeleteBtn" class="fm-btn fm-btn-danger">删除</button>
      </div>
    </div>
  </div>

  <!-- 上下文菜单 -->
  <div id="contextMenu" class="context-menu">
    <div class="context-menu-item" data-action="open">
      <span class="fm-icon">📂</span>
      打开
    </div>
    <div class="context-menu-item" data-action="preview" style="display: none;">
      <span class="fm-icon">👁️</span>
      预览
    </div>
    <div class="context-menu-item" data-action="download">
      <span class="fm-icon">⬇️</span>
      下载
    </div>
    <div class="context-menu-item" data-action="rename">
      <span class="fm-icon">✏️</span>
      重命名
    </div>
    <div class="context-menu-divider"></div>
    <div class="context-menu-item context-menu-item-danger" data-action="delete">
      <span class="fm-icon">🗑️</span>
      删除
    </div>
  </div>

  <!-- Toast 通知 -->
  <div id="toast" class="toast"></div>

  <script src="/js/filemanager.js?v=4" defer></script>
</body>
</html>