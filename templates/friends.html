<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, viewport-fit=cover">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#000000" media="(prefers-color-scheme: dark)">
<meta name="description" content="RustBlog 友链页面 - 与志同道合的朋友建立连接">
<title>{{ title }}</title>
<!-- Disable favicon -->
<link rel="icon" href="data:,">
<!-- Highlight.js CSS (关键) -->
<link rel="stylesheet" href="/css/tokyo-night-dark.min.css">
<!-- 页面基础样式 (关键) -->
<link rel="stylesheet" href="/css/passage-base.css">
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

:root {
  --sidebar-width: 280px;
  --header-height: 60px;
  --glass-bg: rgba(0, 0, 0, 0);
  --glass-border: rgba(255, 255, 255, 0.3);
  --text-primary: rgba(255, 255, 255, 0.9);
  --text-secondary: rgba(255, 255, 255, 0.7);
}

@media (prefers-color-scheme: dark) {
  :root {
    --glass-bg: rgba(0, 0, 0, 0);
    --glass-border: rgba(255, 255, 255, 0.2);
    --text-primary: rgba(255, 255, 255, 0.95);
    --text-secondary: rgba(255, 255, 255, 0.8);
  }
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
  min-height: 100vh;
  color: var(--text-primary);
  overflow-x: hidden;
}

{% if background_image %}
body {
  background-image: linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.3)), url('{{ background_image }}');
}
{% else %}
body {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}
{% endif %}

.container {
  max-width: 900px;
  margin: 0 auto;
  padding: 40px 20px;
}

.page-title {
  text-align: center;
  font-size: 3em;
  margin-bottom: 10px;
  color: rgba(255, 255, 255, 0.95);
  text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
}

.page-subtitle {
  text-align: center;
  font-size: 1.2em;
  color: rgba(255, 255, 255, 0.8);
  margin-bottom: 50px;
}

/* 友链卡片样式 */
.friend-link-card {
  background: rgba(0, 0, 0, 0);
  backdrop-filter: blur(20px) saturate(180%);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  border: 1px solid rgba(255, 255, 255, 0.3);
  padding: 30px;
  border-radius: 20px;
  margin-bottom: 30px;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  display: flex;
  align-items: center;
  gap: 25px;
}

.friend-link-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
}

.friend-avatar {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  object-fit: cover;
  border: 3px solid rgba(255, 255, 255, 0.3);
  flex-shrink: 0;
  transition: transform 0.3s ease;
}

.friend-link-card:hover .friend-avatar {
  transform: scale(1.1);
}

.friend-info {
  flex: 1;
  min-width: 0;
}

.friend-name {
  font-size: 1.6em;
  font-weight: 700;
  margin-bottom: 8px;
  color: rgba(255, 255, 255, 0.95);
}

.friend-motto {
  font-size: 1em;
  color: rgba(255, 255, 255, 0.8);
  margin-bottom: 10px;
  line-height: 1.5;
}

.friend-link {
  display: inline-block;
  padding: 8px 20px;
  background: rgba(255, 255, 255, 0.15);
  color: rgba(255, 255, 255, 0.95);
  text-decoration: none;
  border-radius: 25px;
  font-size: 0.9em;
  transition: background 0.3s ease, transform 0.3s ease;
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.friend-link:hover {
  background: rgba(255, 255, 255, 0.25);
  transform: scale(1.05);
}

.loading {
  text-align: center;
  padding: 60px 20px;
  color: rgba(255, 255, 255, 0.8);
  font-size: 1.2em;
}

.empty-state {
  text-align: center;
  padding: 80px 20px;
  color: rgba(255, 255, 255, 0.8);
}

.empty-state svg {
  width: 80px;
  height: 80px;
  margin-bottom: 20px;
  opacity: 0.6;
}

.empty-state p {
  font-size: 1.2em;
  margin-bottom: 10px;
}

.empty-state small {
  font-size: 0.9em;
  opacity: 0.7;
}

@media (max-width: 768px) {
  .friend-link-card {
    flex-direction: column;
    text-align: center;
    padding: 25px;
  }

  .friend-avatar {
    width: 70px;
    height: 70px;
  }

  .friend-name {
    font-size: 1.4em;
  }

  .page-title {
    font-size: 2.2em;
  }
}

/* 暗色模式适配 */
@media (prefers-color-scheme: dark) {
  .friend-link-card {
    background: rgba(0, 0, 0, 0);
    border-color: rgba(255, 255, 255, 0.2);
  }

  .friend-link {
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.15);
  }

  .friend-link:hover {
    background: rgba(255, 255, 255, 0.2);
  }
}
</style>
</head>
<body>
<div class="container">
  <h1 class="page-title">友链</h1>
  <p class="page-subtitle">与志同道合的朋友建立连接</p>
  
  <div id="friendLinksContainer">
    <div class="loading">加载中...</div>
  </div>
</div>

<script>
// 加载友链列表
async function loadFriendLinks() {
  const container = document.getElementById('friendLinksContainer');
  
  try {
    const response = await fetch('/api/friend-links');
    const result = await response.json();
    
    if (result.success && result.data && result.data.length > 0) {
      container.innerHTML = '';
      
      result.data.forEach((link, index) => {
        const card = document.createElement('div');
        card.className = 'friend-link-card';
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        
        const avatar = link.avatar_url || '/img/avatar.webp';
        const name = link.nickname || '未命名';
        const motto = link.motto || '';
        const url = link.link_url || '#';
        
        card.innerHTML = `
          <img src="${avatar}" alt="${name}" class="friend-avatar" loading="lazy" onerror="this.src='/img/avatar.webp'">
          <div class="friend-info">
            <h2 class="friend-name">${name}</h2>
            ${motto ? `<p class="friend-motto">${motto}</p>` : ''}
            <a href="${url}" target="_blank" rel="noopener noreferrer" class="friend-link">访问博客</a>
          </div>
        `;
        
        container.appendChild(card);
        
        // 延迟动画
        setTimeout(() => {
          card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
          card.style.opacity = '1';
          card.style.transform = 'translateY(0)';
        }, index * 100);
      });
    } else {
      container.innerHTML = `
        <div class="empty-state">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
            <circle cx="9" cy="7" r="4"></circle>
            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
          </svg>
          <p>暂无友链</p>
          <small>博主还没有添加友链哦~</small>
        </div>
      `;
    }
  } catch (error) {
    console.error('加载友链失败:', error);
    container.innerHTML = `
      <div class="empty-state">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="8" x2="12" y2="12"></line>
          <line x1="12" y1="16" x2="12.01" y2="16"></line>
        </svg>
        <p>加载失败</p>
        <small>请稍后重试</small>
      </div>
    `;
  }
}

// 页面加载完成后加载友链
document.addEventListener('DOMContentLoaded', loadFriendLinks);
</script>
</body>
</html>