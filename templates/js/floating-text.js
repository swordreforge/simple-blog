class FloatingTextController{constructor(){this.canvas=null,this.ctx=null,this.isEnabled=!1,this.texts=[],this.particles=[],this.colors=["#3498db","#e74c3c","#2ecc71","#f39c12","#9b59b6"],this.animationId=null,this.init()}init(){this.createCanvas(),this.loadSettings(),this.listenToSettings(),window.addEventListener("resize",()=>this.handleResize()),this.setupClickHandler()}createCanvas(){this.canvas=document.createElement("canvas"),this.canvas.id="floating-text-canvas",this.canvas.style.cssText="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 9999;",this.ctx=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.handleResize()}handleResize(){this.canvas&&(this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight)}setupClickHandler(){document.addEventListener("click",t=>{this.isEnabled&&this.createParticle(t.clientX,t.clientY)})}loadSettings(){try{var t,e=localStorage.getItem("appearanceSettings");e&&(t=JSON.parse(e),this.isEnabled=t.floating_text_enabled||!1,t.floating_texts)&&Array.isArray(t.floating_texts)&&0<t.floating_texts.length&&(this.texts=t.floating_texts)}catch(t){}this.isEnabled&&this.start()}listenToSettings(){window.addEventListener("appearanceSettingsChanged",t=>{t.detail&&(void 0!==t.detail.floating_text_enabled&&(this.isEnabled,this.isEnabled=t.detail.floating_text_enabled,this.isEnabled?this.start():this.stop()),t.detail.floating_texts)&&Array.isArray(t.detail.floating_texts)&&0<t.detail.floating_texts.length&&(this.texts=t.detail.floating_texts)})}start(){this.animationId||(this.texts&&0!==this.texts.length||(this.texts=["perfect","good","excellent","extraordinary","legend"]),this.animate())}stop(){this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null),this.particles=[],this.ctx&&this.canvas&&this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}createParticle(t,e){this.isEnabled&&(t={x:t,y:e,text:this.texts[Math.floor(Math.random()*this.texts.length)],color:this.colors[Math.floor(Math.random()*this.colors.length)],size:18+6*Math.random(),speedY:-.8-.4*Math.random(),life:1,decay:.005+.002*Math.random()},this.particles.push(t))}animate(){if(this.ctx&&this.canvas){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);for(let t=this.particles.length-1;0<=t;t--){var e=this.particles[t];e.y+=e.speedY,e.life-=e.decay,this.ctx.globalAlpha=e.life,this.ctx.fillStyle=e.color,this.ctx.font=`bold ${e.size}px Arial`,this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(e.text,e.x,e.y),e.life<=0&&this.particles.splice(t,1)}(this.isEnabled||0<this.particles.length)&&(this.animationId=requestAnimationFrame(()=>this.animate()))}}updateSettings(t){void 0!==t.floating_text_enabled&&(this.isEnabled=t.floating_text_enabled,this.isEnabled?this.start():this.stop()),t.floating_texts&&Array.isArray(t.floating_texts)&&0<t.floating_texts.length&&(this.texts=t.floating_texts)}setTexts(t){this.texts=t}createAt(t,e){this.createParticle(t,e)}}let floatingTextController=null;document.addEventListener("DOMContentLoaded",function(){setTimeout(()=>{floatingTextController=new FloatingTextController},1e3)}),window.floatingTextController=floatingTextController;
